function Fij = F_KS_linear_vec(x,q,r,param1)

q  = reshape(q,[param1,r])';
q1 = q(:,1); q2 = q(:,2); q3 = q(:,3); q4 = q(:,4);

innerpart = q2.*sin(x*pi/10 + q3) + q4;

Fij = (1/100).*pi.^2.*q2.*sech(innerpart).^2.*(sin(q3+(1/10).*pi.*x)+2.* ...
  q2.*cos(q3+(1/10).*pi.*x).^2.*tanh(innerpart))+...
  (-1/10000).*pi.^4.*q2.*sech(innerpart).^2.*(sin(q3+(1/10).*pi.*x)+ ...
  q2.*(1+7.*cos(2.*q3+(1/5).*pi.*x)).*tanh(innerpart)+(-24).*q2.^2.* ...
  cos(q3+(1/10).*pi.*x).^2.*sin(q3+(1/10).*pi.*x).*tanh(innerpart) ...
  .^2+(-8).*q2.^3.*cos(q3+(1/10).*pi.*x).^4.*tanh(innerpart).^3+4.* ...
  q2.^2.*cos(q3+(1/10).*pi.*x).^2.*sech(innerpart).^2.*(3.*sin(q3+( ...
  1/10).*pi.*x)+4.*q2.*cos(q3+(1/10).*pi.*x).^2.*tanh(innerpart)));

Fij = q1.*Fij;
Fij = sum(Fij);

end