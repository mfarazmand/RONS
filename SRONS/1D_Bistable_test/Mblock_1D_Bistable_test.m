function M = Mblock_1D_Bistable_test(q) 

q1=q(1);q2=q(2);q3=q(3);q4=q(4);q5=q(5);q6=q(6);

c = exp(1).^((-1).*(q2.^2+q5.^2).^(-1).*(q3+(-1).*q6).^2);

xc1 = (q2.^2+q5.^2).^(-1).*(q3.*q5.^2+q2.^2.*q6);

a = q2.^(-2)+q5.^(-2);

M = [4.*a.^(-1/2).*c.*pi.^(1/2).*q1.*q4,2.*a.^(-3/2).*c.*pi.^(1/2).* ...
  q1.*q4.^2.*q5.^(-3)+4.*a.^(-1/2).*c.*pi.^(1/2).*q1.*q4.^2.*q5.^( ...
  -3).*(q6+(-1).*xc1).^2,(-4).*a.^(-1/2).*c.*pi.^(1/2).*q1.*q4.^2.* ...
  q5.^(-2).*(q6+(-1).*xc1);2.*a.^(-3/2).*c.*pi.^(1/2).*q1.^2.*q2.^( ...
  -3).*q4+4.*a.^(-1/2).*c.*pi.^(1/2).*q1.^2.*q2.^(-3).*q4.*(q3+(-1) ...
  .*xc1).^2,3.*a.^(-5/2).*c.*pi.^(1/2).*q1.^2.*q2.^(-3).*q4.^2.* ...
  q5.^(-3)+4.*a.^(-1/2).*c.*pi.^(1/2).*q1.^2.*q2.^(-3).*q4.^2.*q5.^( ...
  -3).*(q3+(-1).*xc1).^2.*(q6+(-1).*xc1).^2+2.*a.^(-3/2).*c.*pi.^( ...
  1/2).*q1.^2.*q2.^(-3).*q4.^2.*q5.^(-3).*(q3.^2+q6.^2+q3.*(4.*q6+( ...
  -6).*xc1)+(-6).*q6.*xc1+6.*xc1.^2),(-2).*a.^(-3/2).*c.*pi.^(1/2).* ...
  q1.^2.*q2.^(-3).*q4.^2.*q5.^(-2).*(2.*q3+q6+(-3).*xc1)+(-4).*a.^( ...
  -1/2).*c.*pi.^(1/2).*q1.^2.*q2.^(-3).*q4.^2.*q5.^(-2).*(q3+(-1).* ...
  xc1).^2.*(q6+(-1).*xc1);(-4).*a.^(-1/2).*c.*pi.^(1/2).*q1.^2.* ...
  q2.^(-2).*q4.*(q3+(-1).*xc1),(-2).*a.^(-3/2).*c.*pi.^(1/2).* ...
  q1.^2.*q2.^(-2).*q4.^2.*q5.^(-3).*(q3+2.*q6+(-3).*xc1)+(-4).*a.^( ...
  -1/2).*c.*pi.^(1/2).*q1.^2.*q2.^(-2).*q4.^2.*q5.^(-3).*(q3+(-1).* ...
  xc1).*(q6+(-1).*xc1).^2,2.*a.^(-3/2).*c.*pi.^(1/2).*q1.^2.*q2.^( ...
  -2).*q4.^2.*q5.^(-2)+4.*a.^(-1/2).*c.*pi.^(1/2).*q1.^2.*q2.^(-2).* ...
  q4.^2.*q5.^(-2).*(q3+(-1).*xc1).*(q6+(-1).*xc1)];
