function F = F0block_1D_Bistable_test(ql,q,r,param1,alpha1,alpha2,alpha3,nu)

ql1=ql(1);ql2=ql(2);ql3=ql(3);
 
qj = reshape(q,[param1,r])'; 
 
qj1=qj(:,1);qj2=qj(:,2);qj3=qj(:,3);

c = exp(1).^((-1).*(ql2.^2+qj2.^2).^(-1).*(ql3+(-1).*qj3).^2);

xc1 = (ql2.^2+qj2.^2).^(-1).*(ql3.*qj2.^2+ql2.^2.*qj3);

a = ql2.^(-2)+qj2.^(-2);

F = [sum((-12).*ql1.*a.^(-5/2).*alpha1.*c.*pi.^(1/2).*qj1.^2.*qj2.^(-2)+2.* ...
  ql1.*a.^(-3/2).*c.*pi.^(1/2).*qj1.^2.*qj2.^(-4).*(2.*nu+6.* ...
  alpha1.*qj2.^4+qj2.^2.*((-2).*alpha3+(-9).*alpha2.*xc1+(-24).* ...
  alpha1.*xc1.^2+3.*qj3.*(alpha2+4.*alpha1.*xc1)))+4.*ql1.*a.^(-1/2) ...
  .*c.*pi.^(1/2).*qj1.^2.*qj2.^(-4).*(2.*nu.*(qj3+(-1).*xc1).^2+ ...
  qj2.^4.*(alpha3+3.*alpha2.*xc1+6.*alpha1.*xc1.^2)+(-1).*qj2.^2.*( ...
  nu+2.*alpha3.*xc1.^2+3.*alpha2.*xc1.^3+4.*alpha1.*xc1.^4+(-1).* ...
  qj3.*xc1.*(2.*alpha3+3.*alpha2.*xc1+4.*alpha1.*xc1.^2))),'all');
sum((-30).*ql1.^2.*ql2.^(-3).*a.^(-7/2).*alpha1.*c.*pi.^(1/2).* ...
  qj1.^2.*qj2.^(-2)+3.*ql1.^2.*ql2.^(-3).*a.^(-5/2).*c.*pi.^(1/2).* ...
  qj1.^2.*qj2.^(-4).*(2.*nu+6.*alpha1.*qj2.^4+qj2.^2.*((-4).* ...
  ql3.^2.*alpha1+(-2).*alpha3+3.*alpha2.*qj3+(-15).*alpha2.*xc1+20.* ...
  alpha1.*qj3.*xc1+(-60).*alpha1.*xc1.^2+ql3.*(6.*alpha2+(-8).* ...
  alpha1.*qj3+40.*alpha1.*xc1)))+4.*ql1.^2.*ql2.^(-3).*a.^(-1/2).* ...
  c.*pi.^(1/2).*qj1.^2.*qj2.^(-4).*(ql3+(-1).*xc1).^2.*(2.*nu.*(qj3+ ...
  (-1).*xc1).^2+qj2.^4.*(alpha3+3.*alpha2.*xc1+6.*alpha1.*xc1.^2)+( ...
  -1).*qj2.^2.*(nu+2.*alpha3.*xc1.^2+3.*alpha2.*xc1.^3+4.*alpha1.* ...
  xc1.^4+(-1).*qj3.*xc1.*(2.*alpha3+3.*alpha2.*xc1+4.*alpha1.* ...
  xc1.^2)))+2.*ql1.^2.*ql2.^(-3).*a.^(-3/2).*c.*pi.^(1/2).*qj1.^2.* ...
  qj2.^(-4).*(2.*nu.*(qj3.^2+(-6).*qj3.*xc1+6.*xc1.^2)+qj2.^4.*( ...
  alpha3+9.*alpha2.*xc1+36.*alpha1.*xc1.^2)+(-1).*qj2.^2.*(nu+12.* ...
  alpha3.*xc1.^2+30.*alpha2.*xc1.^3+60.*alpha1.*xc1.^4+(-2).*qj3.* ...
  xc1.*(3.*alpha3+9.*alpha2.*xc1+20.*alpha1.*xc1.^2))+ql3.^2.*(2.* ...
  nu+6.*alpha1.*qj2.^4+qj2.^2.*((-2).*alpha3+(-9).*alpha2.*xc1+(-24) ...
  .*alpha1.*xc1.^2+3.*qj3.*(alpha2+4.*alpha1.*xc1)))+(-2).*ql3.*(( ...
  -4).*nu.*qj3+6.*nu.*xc1+3.*qj2.^4.*(alpha2+6.*alpha1.*xc1)+ ...
  qj2.^2.*((-2).*xc1.*(3.*alpha3+9.*alpha2.*xc1+20.*alpha1.*xc1.^2)+ ...
  qj3.*(2.*alpha3+9.*alpha2.*xc1+24.*alpha1.*xc1.^2)))),'all');
sum((-3).*ql1.^2.*ql2.^(-2).*a.^(-5/2).*c.*pi.^(1/2).*qj1.^2.*qj2.^( ...
  -2).*((-4).*ql3.*alpha1+3.*alpha2+(-4).*alpha1.*qj3+20.*alpha1.* ...
  xc1)+4.*ql1.^2.*ql2.^(-2).*a.^(-1/2).*c.*pi.^(1/2).*qj1.^2.*qj2.^( ...
  -4).*(ql3+(-1).*xc1).*((-2).*nu.*(qj3+(-1).*xc1).^2+(-1).*qj2.^4.* ...
  (alpha3+3.*alpha2.*xc1+6.*alpha1.*xc1.^2)+qj2.^2.*(nu+2.*alpha3.* ...
  xc1.^2+3.*alpha2.*xc1.^3+4.*alpha1.*xc1.^4+(-1).*qj3.*xc1.*(2.* ...
  alpha3+3.*alpha2.*xc1+4.*alpha1.*xc1.^2)))+2.*ql1.^2.*ql2.^(-2).* ...
  a.^(-3/2).*c.*pi.^(1/2).*qj1.^2.*qj2.^(-4).*((-4).*nu.*qj3+6.*nu.* ...
  xc1+3.*qj2.^4.*(alpha2+6.*alpha1.*xc1)+qj2.^2.*((-2).*xc1.*(3.* ...
  alpha3+9.*alpha2.*xc1+20.*alpha1.*xc1.^2)+qj3.*(2.*alpha3+9.* ...
  alpha2.*xc1+24.*alpha1.*xc1.^2))+ql3.*((-2).*nu+(-6).*alpha1.* ...
  qj2.^4+qj2.^2.*(2.*alpha3+9.*alpha2.*xc1+24.*alpha1.*xc1.^2+(-3).* ...
  qj3.*(alpha2+4.*alpha1.*xc1)))),'all');
];