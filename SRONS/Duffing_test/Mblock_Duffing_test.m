function M = Mblock_Duffing_test(q) 

q1=q(1);q2=q(2);q3=q(3);q4=q(4);q5=q(5);q6=q(6);q7=q(7);q8=q(8);

c = exp(1).^((-1).*(q2.^2+q6.^2).^(-1).*(q3.^2+q4.^2+(-2).*q3.*q7+ ...
  q7.^2+(-2).*q4.*q8+q8.^2));

xc1 = (q2.^2+q6.^2).^(-1).*(q3.*q6.^2+q2.^2.*q7);

xc2 = (q2.^2+q6.^2).^(-1).*(q4.*q6.^2+q2.^2.*q8);

a = q2.^(-2)+q6.^(-2);

M = [4.*a.^(-1).*c.*pi.*q1.*q5,4.*a.^(-2).*c.*pi.*q1.*q5.^2.*q6.^(-3)+ ...
  4.*a.^(-1).*c.*pi.*q1.*q5.^2.*q6.^(-3).*(q7.^2+q8.^2+(-2).*q7.* ...
  xc1+xc1.^2+(-2).*q8.*xc2+xc2.^2),(-4).*a.^(-1).*c.*pi.*q1.*q5.^2.* ...
  q6.^(-2).*(q7+(-1).*xc1),(-4).*a.^(-1).*c.*pi.*q1.*q5.^2.*q6.^(-2) ...
  .*(q8+(-1).*xc2);4.*a.^(-2).*c.*pi.*q1.^2.*q2.^(-3).*q5+4.*a.^(-1) ...
  .*c.*pi.*q1.^2.*q2.^(-3).*q5.*(q3.^2+q4.^2+(-2).*q3.*xc1+xc1.^2+( ...
  -2).*q4.*xc2+xc2.^2),8.*a.^(-3).*c.*pi.*q1.^2.*q2.^(-3).*q5.^2.* ...
  q6.^(-3)+4.*a.^(-1).*c.*pi.*q1.^2.*q2.^(-3).*q5.^2.*q6.^(-3).*( ...
  q3.^2+q4.^2+(-2).*q3.*xc1+xc1.^2+(-2).*q4.*xc2+xc2.^2).*(q7.^2+ ...
  q8.^2+(-2).*q7.*xc1+xc1.^2+(-2).*q8.*xc2+xc2.^2)+4.*a.^(-2).*c.* ...
  pi.*q1.^2.*q2.^(-3).*q5.^2.*q6.^(-3).*(q3.^2+q4.^2+q7.^2+q8.^2+2.* ...
  q3.*(q7+(-2).*xc1)+(-4).*q7.*xc1+4.*xc1.^2+2.*q4.*(q8+(-2).*xc2)+( ...
  -4).*q8.*xc2+4.*xc2.^2),(-4).*a.^(-2).*c.*pi.*q1.^2.*q2.^(-3).* ...
  q5.^2.*q6.^(-2).*(q3+q7+(-2).*xc1)+(-4).*a.^(-1).*c.*pi.*q1.^2.* ...
  q2.^(-3).*q5.^2.*q6.^(-2).*(q7+(-1).*xc1).*(q3.^2+q4.^2+(-2).*q3.* ...
  xc1+xc1.^2+(-2).*q4.*xc2+xc2.^2),(-4).*a.^(-2).*c.*pi.*q1.^2.* ...
  q2.^(-3).*q5.^2.*q6.^(-2).*(q4+q8+(-2).*xc2)+(-4).*a.^(-1).*c.* ...
  pi.*q1.^2.*q2.^(-3).*q5.^2.*q6.^(-2).*(q8+(-1).*xc2).*(q3.^2+ ...
  q4.^2+(-2).*q3.*xc1+xc1.^2+(-2).*q4.*xc2+xc2.^2);(-4).*a.^(-1).* ...
  c.*pi.*q1.^2.*q2.^(-2).*q5.*(q3+(-1).*xc1),(-4).*a.^(-2).*c.*pi.* ...
  q1.^2.*q2.^(-2).*q5.^2.*q6.^(-3).*(q3+q7+(-2).*xc1)+(-4).*a.^(-1) ...
  .*c.*pi.*q1.^2.*q2.^(-2).*q5.^2.*q6.^(-3).*(q3+(-1).*xc1).*(q7.^2+ ...
  q8.^2+(-2).*q7.*xc1+xc1.^2+(-2).*q8.*xc2+xc2.^2),2.*a.^(-2).*c.* ...
  pi.*q1.^2.*q2.^(-2).*q5.^2.*q6.^(-2)+4.*a.^(-1).*c.*pi.*q1.^2.* ...
  q2.^(-2).*q5.^2.*q6.^(-2).*(q3+(-1).*xc1).*(q7+(-1).*xc1),4.*a.^( ...
  -1).*c.*pi.*q1.^2.*q2.^(-2).*q5.^2.*q6.^(-2).*(q3+(-1).*xc1).*(q8+ ...
  (-1).*xc2);(-4).*a.^(-1).*c.*pi.*q1.^2.*q2.^(-2).*q5.*(q4+(-1).* ...
  xc2),(-4).*a.^(-2).*c.*pi.*q1.^2.*q2.^(-2).*q5.^2.*q6.^(-3).*(q4+ ...
  q8+(-2).*xc2)+(-4).*a.^(-1).*c.*pi.*q1.^2.*q2.^(-2).*q5.^2.*q6.^( ...
  -3).*(q4+(-1).*xc2).*(q7.^2+q8.^2+(-2).*q7.*xc1+xc1.^2+(-2).*q8.* ...
  xc2+xc2.^2),4.*a.^(-1).*c.*pi.*q1.^2.*q2.^(-2).*q5.^2.*q6.^(-2).*( ...
  q7+(-1).*xc1).*(q4+(-1).*xc2),2.*a.^(-2).*c.*pi.*q1.^2.*q2.^(-2).* ...
  q5.^2.*q6.^(-2)+4.*a.^(-1).*c.*pi.*q1.^2.*q2.^(-2).*q5.^2.*q6.^( ...
  -2).*(q4+(-1).*xc2).*(q8+(-1).*xc2)];
