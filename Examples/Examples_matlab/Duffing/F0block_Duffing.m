function F = F0block_Duffing(ql,q,r,param1,alpha1,alpha2,alpha3,nu)

ql1=ql(1);ql2=ql(2);ql3=ql(3);ql4=ql(4);
 
qj = reshape(q,[param1,r])'; 
 
qj1=qj(:,1);qj2=qj(:,2);qj3=qj(:,3);qj4=qj(:,4);

c = exp(1).^((-1).*(ql2.^2+qj2.^2).^(-1).*(ql3.^2+ql4.^2+(-2).*ql3.* ...
  qj3+qj3.^2+(-2).*ql4.*qj4+qj4.^2));

xc1 = (ql2.^2+qj2.^2).^(-1).*(ql3.*qj2.^2+ql2.^2.*qj3);

xc2 = (ql2.^2+qj2.^2).^(-1).*(ql4.*qj2.^2+ql2.^2.*qj4);

a = ql2.^(-2)+qj2.^(-2);

F = [sum(2.*ql1.*a.^(-2).*c.*pi.*qj1.^2.*qj2.^(-4).*(2.*nu+qj2.^2.*(alpha2+ ...
  (-3).*alpha3.*qj4.*xc1+3.*alpha3.*xc1.*xc2))+(-2).*ql1.*a.^(-1).* ...
  c.*pi.*qj1.^2.*qj2.^(-4).*(alpha2.*qj2.^4+(-4).*nu.*(qj4+(-1).* ...
  xc2).^2+2.*qj2.^2.*(nu+qj3.*xc2+(-1).*xc1.*xc2+(-1).*alpha1.*xc1.* ...
  xc2+(-1).*alpha3.*xc1.^3.*xc2+(-1).*alpha2.*xc2.^2+qj4.*(alpha1.* ...
  xc1+alpha3.*xc1.^3+alpha2.*xc2))),'all');
sum(2.*ql1.^2.*ql2.^(-3).*a.^(-3).*c.*pi.*qj1.^2.*qj2.^(-4).*(4.*nu+ ...
  qj2.^2.*(2.*alpha2+(-3).*ql4.*alpha3.*xc1+(-9).*alpha3.*qj4.*xc1+ ...
  3.*ql3.*alpha3.*(qj4+(-1).*xc2)+12.*alpha3.*xc1.*xc2))+(-2).* ...
  ql1.^2.*ql2.^(-3).*a.^(-1).*c.*pi.*qj1.^2.*qj2.^(-4).*(ql3.^2+ ...
  ql4.^2+(-2).*ql3.*xc1+xc1.^2+(-2).*ql4.*xc2+xc2.^2).*(alpha2.* ...
  qj2.^4+(-4).*nu.*(qj4+(-1).*xc2).^2+2.*qj2.^2.*(nu+qj3.*xc2+(-1).* ...
  xc1.*xc2+(-1).*alpha1.*xc1.*xc2+(-1).*alpha3.*xc1.^3.*xc2+(-1).* ...
  alpha2.*xc2.^2+qj4.*(alpha1.*xc1+alpha3.*xc1.^3+alpha2.*xc2)))+2.* ...
  ql1.^2.*ql2.^(-3).*a.^(-2).*c.*pi.*qj1.^2.*qj2.^(-4).*((-2).*nu.* ...
  qj2.^2+(-1).*alpha2.*qj2.^4+4.*nu.*qj4.^2+(-4).*alpha1.*qj2.^2.* ...
  qj4.*xc1+2.*nu.*xc1.^2+alpha2.*qj2.^2.*xc1.^2+(-11).*alpha3.* ...
  qj2.^2.*qj4.*xc1.^3+(-4).*qj2.^2.*qj3.*xc2+(-16).*nu.*qj4.*xc2+( ...
  -4).*alpha2.*qj2.^2.*qj4.*xc2+6.*qj2.^2.*xc1.*xc2+6.*alpha1.* ...
  qj2.^2.*xc1.*xc2+13.*alpha3.*qj2.^2.*xc1.^3.*xc2+14.*nu.*xc2.^2+ ...
  7.*alpha2.*qj2.^2.*xc2.^2+(-3).*alpha3.*qj2.^2.*qj4.*xc1.*xc2.^2+ ...
  3.*alpha3.*qj2.^2.*xc1.*xc2.^3+ql3.^2.*(2.*nu+qj2.^2.*(alpha2+(-3) ...
  .*alpha3.*qj4.*xc1+3.*alpha3.*xc1.*xc2))+ql4.^2.*(2.*nu+qj2.^2.*( ...
  alpha2+(-3).*alpha3.*qj4.*xc1+3.*alpha3.*xc1.*xc2))+2.*ql3.*((-2) ...
  .*nu.*xc1+(-1).*qj2.^2.*(alpha2.*xc1+(-1).*qj4.*(alpha1+6.* ...
  alpha3.*xc1.^2)+xc2+alpha1.*xc2+6.*alpha3.*xc1.^2.*xc2))+2.*ql4.*( ...
  4.*nu.*qj4+(-6).*nu.*xc2+qj2.^2.*(qj3+(-1).*xc1+(-1).*alpha1.*xc1+ ...
  (-1).*alpha3.*xc1.^3+(-3).*alpha2.*xc2+(-3).*alpha3.*xc1.*xc2.^2+ ...
  qj4.*(alpha2+3.*alpha3.*xc1.*xc2)))),'all');
sum((-3).*ql1.^2.*ql2.^(-2).*a.^(-3).*alpha3.*c.*pi.*qj1.^2.*qj2.^(-2) ...
  .*(qj4+(-1).*xc2)+2.*ql1.^2.*ql2.^(-2).*a.^(-1).*c.*pi.*qj1.^2.* ...
  qj2.^(-4).*(ql3+(-1).*xc1).*(alpha2.*qj2.^4+(-4).*nu.*(qj4+(-1).* ...
  xc2).^2+2.*qj2.^2.*(nu+qj3.*xc2+(-1).*xc1.*xc2+(-1).*alpha1.*xc1.* ...
  xc2+(-1).*alpha3.*xc1.^3.*xc2+(-1).*alpha2.*xc2.^2+qj4.*(alpha1.* ...
  xc1+alpha3.*xc1.^3+alpha2.*xc2)))+(-2).*ql1.^2.*ql2.^(-2).*a.^(-2) ...
  .*c.*pi.*qj1.^2.*qj2.^(-4).*((-2).*nu.*xc1+(-1).*qj2.^2.*(alpha2.* ...
  xc1+(-1).*qj4.*(alpha1+6.*alpha3.*xc1.^2)+xc2+alpha1.*xc2+6.* ...
  alpha3.*xc1.^2.*xc2)+ql3.*(2.*nu+qj2.^2.*(alpha2+(-3).*alpha3.* ...
  qj4.*xc1+3.*alpha3.*xc1.*xc2))),'all');
sum(3.*ql1.^2.*ql2.^(-2).*a.^(-3).*alpha3.*c.*pi.*qj1.^2.*qj2.^(-2).* ...
  xc1+2.*ql1.^2.*ql2.^(-2).*a.^(-1).*c.*pi.*qj1.^2.*qj2.^(-4).*(ql4+ ...
  (-1).*xc2).*(alpha2.*qj2.^4+(-4).*nu.*(qj4+(-1).*xc2).^2+2.* ...
  qj2.^2.*(nu+qj3.*xc2+(-1).*xc1.*xc2+(-1).*alpha1.*xc1.*xc2+(-1).* ...
  alpha3.*xc1.^3.*xc2+(-1).*alpha2.*xc2.^2+qj4.*(alpha1.*xc1+ ...
  alpha3.*xc1.^3+alpha2.*xc2)))+(-2).*ql1.^2.*ql2.^(-2).*a.^(-2).* ...
  c.*pi.*qj1.^2.*qj2.^(-4).*(4.*nu.*qj4+(-6).*nu.*xc2+qj2.^2.*(qj3+( ...
  -1).*xc1+(-1).*alpha1.*xc1+(-1).*alpha3.*xc1.^3+(-3).*alpha2.*xc2+ ...
  (-3).*alpha3.*xc1.*xc2.^2+qj4.*(alpha2+3.*alpha3.*xc1.*xc2))+ql4.* ...
  (2.*nu+qj2.^2.*(alpha2+(-3).*alpha3.*qj4.*xc1+3.*alpha3.*xc1.*xc2) ...
  )),'all');
];